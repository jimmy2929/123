<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" />
    <style>
        @import url(https://fonts.googleapis.com/earlyaccess/cwtexyen.css);

        body {
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin: 0px;
        }

        #contain {
            width: 100vw;
            height: 200vh;
            display: flex;
            justify-content: left;
            align-items: center;
            flex-direction: column;
        }

        #top {
            width: 100vw;
            display: flex;
            background-color: #d2c7b9;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #draw {
            width: 100vw;
            height: 45vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #bc {
            width: 43vh;
            height: 43vh;
            background-color: cadetblue;
            border-radius: 50%;
            box-shadow: 3px 3px 25px #202020;
            position: absolute;
            z-index: 1;
        }

        #circle {
            width: 45vh;
            height: 45vh;
            border-radius: 50%;
            position: absolute;
            z-index: 2;
        }

        #point {
            height: 15vh;
            width: 15vh;
            background-color: #b6ac98;
            position: absolute;
            border-radius: 50%;
            z-index: 3;
            transition: transform 3s cubic-bezier(.2, 0.93, .43, 1);
        }

        #point::after {
            content: '';
            position: absolute;
            left: 3.5vh;
            top: -12vh;
            border-width: 8vh 4vh;
            border-style: solid;
            border-color: transparent;
            border-bottom-color: #b6ac98;
            transform-origin: center;
        }

        #choice {
            width: 100vw;
            height: 42vh;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }

        .store {
            width: 35vw;
            height: 5vh;
            margin: 1vh 5vw;
            text-decoration: none;
            box-shadow: 1vh 1vh #a39485;
            border: 1.5px solid #a39485;
            display: flex;
            flex-wrap: nowrap;
            justify-content: left;
            align-items: center;
        }

        a:nth-child(1) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #b4a57b;
        }

        a:nth-child(2) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #e39b64d7;
        }

        a:nth-child(3) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #c7bc92;
        }

        a:nth-child(4) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #f8c255d5;
        }

        a:nth-child(5) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #b3cfe2e3;
        }

        a:nth-child(6) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #ebe5d9;
        }

        a:nth-child(7) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #9ec098;
        }

        a:nth-child(8) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #D5D2DD;
        }

        a:nth-child(9) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #B1BEC4;
        }

        a:nth-child(10) .sq {
            width: 2.5vh;
            height: 2.5vh;
            margin: 5px;
            background: #A9A0A5;
        }


        .text {
            font-size: 4vw;
            color: rgb(68, 65, 51);
            font-family: Microsoft JhengHei;
            font-weight: 600;
        }

        #change {
            width: 100vw;
            height: 8vh;
            font-size: 4vh;
            color: rgba(48, 38, 30, 0.801);
            background-color: rgba(168, 133, 109, 0.89);
            font-weight: 600;
            text-align: center;
            box-shadow: -3px 0px 5px black;
            line-height: 8vh;
            font-family: Microsoft JhengHei;
        }
        #result {
            width: 100vw;
            height: 100vh;
            display: flex;
            background-color: rgba(202, 199, 186, 0.863);
            flex-direction: column;
            justify-content: left;
            align-items: center;
        }

        #img {
            width: 100vw;
            height: 40vh;
        }
        #img img{
            height: 40vh;
            opacity: 0.6;
        }
        #intro {
            width: 90vw;
            height: 32vh;
            display:flex;
            flex-direction: column;
            align-items: center;
            justify-content: left;
        }

        #s_name {
            width: 90vw;
            height: 10vh;
            text-align: left;
            font-family: Microsoft JhengHei;
            color: rgb(61, 59, 59);
            font-weight: 600;
            font-size: 12vw;
            margin-bottom: 2vh;
        }

        #s_score {
            width: 90vw;
            text-align: left;
            font-family: Microsoft JhengHei;
            color: rgba(0, 0, 0, 0.616);
            font-weight: 600;
            font-size: 2.8vh;
            margin-bottom: 1vh;
        }

        #s_distance {
            width: 90vw;
            text-align: left;
            font-family: Microsoft JhengHei;
            color: rgba(0, 0, 0, 0.616);
            font-weight: 600;
            font-size: 2.8vh;
            margin-bottom: 1vh;
        }

        #s_time {
            width: 90vw;
            text-align: left;
            font-family: Microsoft JhengHei;
            color: rgba(0, 0, 0, 0.616);
            font-weight: 600;
            font-size: 2.8vh;
            margin-bottom: 1vh;
        }

        #func {
            width: 100vw;
            height: 20vh;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .function {
            width: 15vh;
            height: 15vh;
            margin: 2vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .icon{
            width: 6vh;
            margin: 1vh;
        }
        .fun_txt{
            font-family: Microsoft JhengHei;
            color: rgba(0, 0, 0, 0.616);
            text-align: center;
            font-weight: 600;
            font-size: 3vh;
        }
        #change_down {
            width: 100vw;
            height: 8vh;
            font-size: 4vh;
            color: rgba(48, 38, 30, 0.801);
            background-color: rgba(168, 133, 109, 0.89);
            font-weight: 600;
            text-align: center;
            box-shadow: -3px 0px 5px black;
            line-height: 8vh;
            font-family: Microsoft JhengHei;
        }
    </style>
</head>

<body>
    <div id="contain">
        <div id="top">
            <div id="draw">
                <div id="bc"></div>
                <img id="circle" src="img/draw.png" alt="">
                <div id="point"></div>
            </div>
            <div id="choice">
                <a id="1" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">滄洲燒臘飯</div>
                </a>
                <a id="2" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">珍寶燒臘</div>
                </a>
                <a id="3" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">佳佳早餐店</div>
                </a>
                <a id="4" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">麥軒活力站</div>
                </a>
                <a id="5" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">麥當勞中山店</div>
                </a>
                <a id="6" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">吃飯大學</div>
                </a>
                <a id="7" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">試嘗之</div>
                </a>
                <a id="8" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">異國便當店</div>
                </a>
                <a id="9" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">JL</div>
                </a>
                <a id="10" class="store" href="#result">
                    <div class="sq"></div>
                    <div class="text">陳媽媽便當店</div>
                </a>
            </div>
        </div>
        <div id="change">繼續探索</div>
        
        <div id="result">
            <div id="img"><img src="img/bgi.jpg" alt=""></div>
            <div id="intro">
                <div id="s_name">滄洲燒臘店</div>
                <div id="s_score">評分 : 4.7</div>
                <div id="s_distance">距離 : 1.3公里</div>
                <div id="s_time">營業時間 : 11:00-23:00</div>
            </div>
            <div id="func">
                <div class="function"><img class="icon" src="img/phone.png" alt=""><div class="fun_txt">致電</div></div>
                <div class="function"><img class="icon" src="img/go.png" alt=""><div class="fun_txt">馬上去</div></div>
                <div class="function"><img class="icon" src="img/share.png" alt=""><div class="fun_txt">分享</div></div>
            </div>
            <div id="change_down">我再選選</div>
        </div>
    </div>
    <script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
    <script src="http://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script>
        function initializeApp(data) {
            var userid = data.context.userid;
        }
        $(document).ready(function () {
            liff.init(function (data) {
                initializeApp(data);
            })
        })




        let getEle = document.getElementsByClassName.bind(document);
        let pointer = document.getElementById('point');
        let result = document.getElementById('s_name');

        let onRotation = false; //紀錄有沒有在轉

        let store_result = ['滄洲燒臘店', '珍寶燒臘', '佳佳早餐店', '麥軒活力站', '麥當勞中山店', '吃飯大學', '試嘗之', '異國便當店', 'JL', '陳媽媽便當店']


        //隨機角度

        let getStore = (function () {
            currentDeg = 0;
            return function () {
                //轉兩到三圈
                let rotateDeg = Math.random() * 360 + 1080;
                currentDeg += rotateDeg;
                let rewardText = store_result[Math.floor((currentDeg + 18) % 360 / 36)]

                return {
                    deg: currentDeg,
                    text: rewardText
                }
            }
        })();

        pointer.addEventListener('click', () => {
            if (onRotation) return;
            console.log('開始選店');
            onRotation = true;
            let nextStatus = getStore();
            console.log(nextStatus);
            result.innerHTML = nextStatus.text;
            pointer.style.transform = `rotateZ(${nextStatus.deg}deg)`;
        })

        pointer.addEventListener('transitionend', () => {
            console.log('抽店結束');
            onRotation = false;
        })
                $(document).ready(function () {
                    $(function () {
                        $('#point').click(function () {
                            setTimeout(() => { // 等閃爍三下結束
                                $('html,body').animate({ scrollTop: $('#result').offset().top }, 500);
                            }, 3000);
                        });
                    });
                }); 
            </script>
    </body>

</html>
